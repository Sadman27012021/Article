import{s as x,a as E,u as O,g as I,b as L,o as M}from"../chunks/scheduler.XrIoRwzV.js";import{S as P,i as U,e as V,c as z,a as B,d as $,l as F,g as G,p as H,q as J}from"../chunks/index.ST5S3DPj.js";import{f as K,a as h,d as f,g as p,h as N,u as v,c as Q,o as T,q as W}from"../chunks/firebase.jHORW_KV.js";import{a as X}from"../chunks/store.RIr_eGut.js";function Y(i){let e,o;const l=i[1].default,a=E(l,i,i[0],null);return{c(){e=V("div"),a&&a.c(),this.h()},l(t){e=z(t,"DIV",{class:!0});var n=B(e);a&&a.l(n),n.forEach($),this.h()},h(){F(e,"class","mainContainer svelte-lypkjf")},m(t,n){G(t,e,n),a&&a.m(e,null),o=!0},p(t,[n]){a&&a.p&&(!o||n&1)&&O(a,l,t,t[0],o?L(l,t[0],n,null):I(t[0]),null)},i(t){o||(H(a,t),o=!0)},o(t){J(a,t),o=!1},d(t){t&&$(e),a&&a.d(t)}}}function Z(i,e,o){let{$$slots:l={},$$scope:a}=e;const t=["/user","/send","/myArticles"];return M(()=>K.onAuthStateChanged(async r=>{const _=window.location.pathname;if(!r&&t.includes(_)){window.location.href="/";return}if(r&&_==="/auth"){window.location.href="/user";return}if(r&&_==="/"){window.location.href="/user";return}if(!r)return;const y=h(f,"ref","colRef"),q=h(f,r.email,"user"),C=await p(q),d=r.email;let u="";for(let s=0;s<d.length;s++){const c=d[s];if(c==="@")break;u+=c}u=u.toUpperCase();const A={email:r.email,username:u};if(!C.exists()){const s=h(f,r.email,"user");await N(s,A)}p(y).then(s=>{if(!s.data().array.includes(d)){const g=[...s.data().array||[],d];return v(y,{array:g})}}),await p(y).then(s=>{const c=h(f,"ref","docRef"),g=s.data().array;for(let D of g){let S=Q(f,D);T(W(S),j=>{j.docs.forEach(m=>{p(c).then(R=>{const w={heading:m.data().heading,confirmed:m.data().confirmed};if(!R.data().array.some(b=>b.heading===w.heading&&b.confirmed===w.confirmed)&&(m.data().heading!==void 0||m.data().confirmation!==void 0)){const k=[...R.data().array||[],w];return v(c,{array:k})}})})})}}),X.update(()=>({user:r,data:A}))})),i.$$set=n=>{"$$scope"in n&&o(0,a=n.$$scope)},[a,l]}class ot extends P{constructor(e){super(),U(this,e,Z,Y,x,{})}}export{ot as component};
